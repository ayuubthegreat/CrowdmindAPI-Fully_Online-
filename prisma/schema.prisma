generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String @id @default(cuid())
  websiteID Int
  name      String
  email     String @unique
  password  String
  role      Role

  @@map("users_table")
}

// CrowdMind Specific Models 
model community_card {
  id          String   @id @default(cuid())
  title       String
  description String
  content     String
  userID      String
  priority    Int
  status      Status
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  tags        String   @default("")

  @@map("community_cards_table")
}

// GitsPedia Specific Models

model project {
  id           String      @id @default(cuid())
  userID       String
  websiteID    Int
  title        String
  description  String
  tags         String
  content      String
  release_date String
  objectives   Objective[]

  @@map("projects_table")
}

model Objective {
  id          String  @id @default(cuid())
  userID      String
  projectID   String
  project     project @relation(fields: [projectID], references: [id])
  title       String
  description String
  completed   Boolean
  step        Int

  @@map("objectives_table")
}

// Wikipedia/Fandom Models

// Main wiki page (e.g., "Iron Man", "Darth Vader")
model WikiPage {
  id              String   @id @default(cuid())
  creatorID       String
  title           String // Page title (e.g., "Iron Man")
  search_blurb    String // Short description for search results (max 50 chars)
  intro_paragraph String   @db.Text // Lead section (no heading)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Relations
  infobox    WikiInfobox?
  sections   WikiSection[]
  references WikiReference[]

  @@map("wikipedia")
}

// Infobox (the information panel on the side of Wikipedia pages)
// Example: For "Iron Man" - shows Real Name, First Appearance, Powers, etc.
model WikiInfobox {
  id     String   @id @default(cuid())
  pageId String   @unique
  page   WikiPage @relation(fields: [pageId], references: [id], onDelete: Cascade)
  title  String? // Infobox title (e.g., "Character Information")
  image  String? // Featured image URL

  // One infobox contains multiple fields (key-value pairs)
  fields WikiInfoboxField[]

  @@map("wikipedia_item_description_table")
}

// Individual fields in the infobox (key-value pairs)
// Example: { heading: "Real Name", content: "Tony Stark" }
// Example: { heading: "First Appearance", content: "Tales of Suspense #39" }
model WikiInfoboxField {
  id        String      @id @default(cuid())
  infoboxId String
  infobox   WikiInfobox @relation(fields: [infoboxId], references: [id], onDelete: Cascade)
  heading   String? // Field name (e.g., "Real Name", "Species", "Occupation")
  content   String?     @db.Text // Field value (e.g., "Tony Stark", "Human", "Superhero")

  @@map("sub_descriptions_table")
}

// Content sections of the article (e.g., "History", "Powers and Abilities")
model WikiSection {
  id      String   @id @default(cuid())
  pageId  String
  page    WikiPage @relation(fields: [pageId], references: [id], onDelete: Cascade)
  heading String? // Section heading (optional for lead section)
  content String   @db.Text // Section content in markdown/text
  order   Int      @default(0) // Display order

  @@index([pageId])
  @@map("wiki_sections")
}

// References/Citations for the article
model WikiReference {
  id     String   @id @default(cuid())
  pageId String
  page   WikiPage @relation(fields: [pageId], references: [id], onDelete: Cascade)
  title  String // Reference title
  url    String? // Reference URL (optional)
  order  Int      @default(0) // Display order

  @@index([pageId])
  @@map("wiki_references")
}

model foodForm {
  id            String @id @default(cuid())
  userID        String
  name          String
  email_address String
  phone_number  String
  home_address  String

  @@map("community_heart_mn_data")
}

enum Status {
  under_review
  planned
  done
}

enum Role {
  supa_admin
  admin
  user
}
